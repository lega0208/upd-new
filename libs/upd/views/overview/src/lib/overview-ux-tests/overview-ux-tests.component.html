<div class="container-fluid my-4 gx-0">
  <div class="row">
    <div class="col-lg-3 col-sm-12">
      <upd-apex-radial-bar
        [title]="'kpi-ux-test-success-all-title'"
        [titleSuffix]="'average success rate'"
        [titleTooltip]="'kpi-ux-test-success-all-tooltip'"
        [preLabel]="'Target'"
        [valueLabel]="0.8"
        [current]="(kpiTotAvgSuccessRate$ | async) || 0"
        [kpiObjectiveCriteria]="uxTestsKpiObjectiveCriteria"
        [keyword]="'ux'"
        modal="{{ 'kpi-ux-test-success-all-guidance' | translate }}"
      >
      {{
        'kpi-ux-test-success-all-text-unique'
          | translate
            : {
                unique: (uniqueTaskTestedLatestTestKpi$ | async) || 0
              }
      }}
      <br />
      {{
          'kpi-ux-test-success-all-text-total'
            | translate
              : {
                  total: (totalTasks$ | async) || 0
                }
      }}   
      </upd-apex-radial-bar>
    </div>
    <div class="col-lg-3 col-sm-12">
      <upd-apex-radial-bar
        class="custom-radial-bar"
        [title]="'kpi-ux-test-improved-title'"
        [titleSuffix]="'average success rate'"
        [titleTooltip]="'kpi-ux-test-improved-tooltip'"
        [preLabel]="'Target'"
        [valueLabel]="0.8"
        [current]="(improvedKpiSuccessRateValidation$ | async) || 0"
        [kpiObjectiveCriteria]="uxTestsKpiObjectiveCriteria"
        [keyword]="'ux'"
        modal="{{ 'kpi-ux-test-improved-guidance' | translate }}"
      >
        <div>
          <ng-container
            *ngIf="{
              value: improvedKpiSuccessRateDifferencePointsRounded$ | async
            } as improvedKpi"
          >
            <span
              [style.color]="getTrendIconAndColor(improvedKpi.value ?? 0).color"
            >
              <i class="material-icons">{{
                getTrendIconAndColor(improvedKpi.value ?? 0).iconName
              }}</i>
              {{ improvedKpi.value | number: undefined : currentLangSignal() }} {{ 'percentage-points' | translate }}
            </span>
            <br />
            {{
              'from-to-improvement'
                | translate
                  : {
                      baseline: (improvedKpiSuccessRateBaseline$ | async | percent) || 0,
                      validation: (improvedKpiSuccessRateValidation$ | async | percent) || 0
                    }
            }}
            <br />
            <br />
            {{
                'kpi-ux-test-improved-text-total'
                  | translate
                    : {
                        total: (uniqueTaskTestedLatestTestKpi$ | async) || 0
                      }
            }}
            <br />
            {{
              'kpi-ux-test-improved-text-unique'
                | translate
                  : {
                      unique: (improvedKpiUniqueTasks$ | async) || 0
                    }
            }}
          </ng-container>
        </div>
      </upd-apex-radial-bar>
    </div>
    <div class="col-lg-3 col-sm-12">
      <upd-apex-radial-bar
        class="custom-radial-bar"
        [title]="'kpi-ux-test-wos-improved-title'"
        [titleSuffix]="'average success rate'"
        [titleTooltip]="'kpi-ux-test-wos-improved-tooltip'"
        [preLabel]="'Target'"
        [valueLabel]="0.8"
        [current]="(wosImprovedKpiSuccessRateValidation$ | async) || 0"
        [kpiObjectiveCriteria]="uxTestsKpiObjectiveCriteria"
        [keyword]="'ux'"
        modal="{{ 'kpi-ux-test-wos-improved-guidance' | translate }}"
      >
        <div>
          <ng-container
            *ngIf="{
              value: wosImprovedKpiSuccessRateDifferencePointsRounded$ | async
            } as improvedKpi"
          >
            <span
              [style.color]="getTrendIconAndColor(improvedKpi.value ?? 0).color"
            >
              <i class="material-icons">{{
                getTrendIconAndColor(improvedKpi.value ?? 0).iconName
              }}</i>
              {{ improvedKpi.value | number: undefined : currentLangSignal() }} {{ 'percentage-points' | translate }}
            </span>
            <br />
            {{
              'from-to-improvement'
                | translate
                  : {
                      baseline: (wosImprovedKpiSuccessRateBaseline$ | async | percent) || 0,
                      validation: (wosImprovedKpiSuccessRateValidation$ | async | percent) || 0
                    }
            }}
            <br />
            <br /> 
            {{
                'kpi-ux-test-improved-text-total'
                  | translate
                    : {
                        total: (uniqueTaskTestedLatestTestKpi$ | async) || 0
                      }
              }}
            <br />   
            {{
              'kpi-ux-test-improved-text-unique'
                | translate
                  : {
                      unique: (wosImprovedKpiUniqueTasks$ | async) || 0
                    }
            }}
          </ng-container>
        </div>
      </upd-apex-radial-bar>
    </div>
    <div class="col-lg-3 col-sm-12">
      <upd-apex-radial-bar
        class="custom-radial-bar"
        [title]="'kpi-ux-test-top50-title'"
        [titleSuffix]="'average success rate'"
        [titleTooltip]="'kpi-ux-test-top50-tooltip'"
        [preLabel]="'Target'"
        [valueLabel]="0.8"
        [current]="(improvedKpiTopSuccessRateValidation$ | async) || 0"
        [kpiObjectiveCriteria]="uxTestsKpiObjectiveCriteria"
        [keyword]="'ux'"
        modal="{{ 'kpi-ux-test-top50-guidance' | translate }}"
      >
        <div>
          <ng-container
            *ngIf="{
              value: improvedKpiTopSuccessRateDifferencePointsRounded$ | async
            } as improvedTopKpi"
          >
            <span
              [style.color]="
                getTrendIconAndColor(improvedTopKpi.value ?? 0).color
              "
            >
              <i class="material-icons">{{
                getTrendIconAndColor(improvedTopKpi.value ?? 0).iconName
              }}</i>
              {{ improvedTopKpi.value | number: undefined : currentLangSignal() }} {{ 'percentage-points' | translate }}
            </span>
            <br />
            {{
              'from-to-improvement'
                | translate
                  : {
                      baseline: (improvedKpiTopSuccessRateBaseline$ | async | percent) || 0,
                      validation: (improvedKpiTopSuccessRateValidation$ | async | percent) || 0
                    }
            }}
            <br />
            <br />
            {{
                'kpi-ux-test-top-text-total'
                  | translate
                    : {
                        total: (improvedKpiTopTasks$ | async) || 0
                      }
              }}
            <br />  
            {{
              'kpi-ux-test-top-text-unique'
                | translate
                  : {
                      unique: (improvedKpiTopUniqueTasks$ | async) || 0
                    }
            }}
            <br />
            {{
              'kpi-ux-test-top-text-not-tested' 
                | translate 
                  : { 
                      nottested: 
                        ((improvedKpiTopTasksCount$ | async) ?? 0) -
                        ((improvedKpiTopTasks$ | async) ?? 0)
                  }
            }}
          </ng-container>
        </div>
      </upd-apex-radial-bar>
    </div>
  </div>
</div>  

<div class="container-fluid gx-0">
  <div class="row my-4">
    <div class="col-lg-4 col-sm-12">
      <upd-data-card
        [current]="kpiTestsCompleted$ | async"
        [title]="'tests-completed-since2018'"
      ></upd-data-card>
    </div>
    <div class="col-lg-4 col-sm-12">
      <upd-data-card
        [current]="tasksTested$ | async"
        [title]="'tasks-tested-since2018'"
      ></upd-data-card>
    </div>
    <div class="col-lg-4 col-sm-12">
      <upd-data-card
        [current]="participantsTested$ | async"
        [title]="'participants-since2018'"
      ></upd-data-card>
    </div>
  </div>
</div>
  
<div class="container-fluid gx-0">
  <div class="container-fluid my-4 gx-0">
    <div class="row">
      <div class="col">
        <upd-data-table-card
          [data]="(uxChartData | async) || []"
          [cols]="uxChartCols"
          [title]="'UX tests by project'"
          [sortField]="'startDate'"
          [sortOrder]="'desc'"
        ></upd-data-table-card>
      </div>
    </div>
  </div>
</div>
